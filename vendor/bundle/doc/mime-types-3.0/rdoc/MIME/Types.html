<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class MIME::Types - mime-types-3.0 Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script src="../js/jquery.js"></script>
<script src="../js/darkfish.js"></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#class-MIME::Types-label-The+Default+mime-types+Registry">The Default mime-types Registry</a>
    <li><a href="#class-MIME::Types-label-Usage">Usage</a>
  </ul>
</div>


  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Enumerable</span>
  
  
  
    <li><span class="include">Enumerable</span>
  
  
  </ul>
</div>

    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-5B-5D">::[]</a>
    
    <li ><a href="#method-c-__instances__">::__instances__</a>
    
    <li ><a href="#method-c-__types__">::__types__</a>
    
    <li ><a href="#method-c-add">::add</a>
    
    <li ><a href="#method-c-count">::count</a>
    
    <li ><a href="#method-c-each">::each</a>
    
    <li ><a href="#method-c-lazy_load-3F">::lazy_load?</a>
    
    <li ><a href="#method-c-load_default_mime_types">::load_default_mime_types</a>
    
    <li ><a href="#method-c-load_mode">::load_mode</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-of">::of</a>
    
    <li ><a href="#method-c-reindex_extensions">::reindex_extensions</a>
    
    <li ><a href="#method-c-type_for">::type_for</a>
    
    <li ><a href="#method-i-5B-5D">#[]</a>
    
    <li ><a href="#method-i-add">#add</a>
    
    <li ><a href="#method-i-add_type">#add_type</a>
    
    <li ><a href="#method-i-add_type_variant-21">#add_type_variant!</a>
    
    <li ><a href="#method-i-count">#count</a>
    
    <li ><a href="#method-i-each">#each</a>
    
    <li ><a href="#method-i-index_extensions-21">#index_extensions!</a>
    
    <li ><a href="#method-i-match">#match</a>
    
    <li ><a href="#method-i-of">#of</a>
    
    <li ><a href="#method-i-prune_matches">#prune_matches</a>
    
    <li ><a href="#method-i-reindex_extensions-21">#reindex_extensions!</a>
    
    <li ><a href="#method-i-type_for">#type_for</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-MIME::Types">
  <h1 id="class-MIME::Types" class="class">
    class MIME::Types
  </h1>

  <section class="description">
    
<p><a href="Types.html">MIME::Types</a> is a registry of <a
href="../MIME.html">MIME</a> types. It is both a class (created with <a
href="Types.html#method-c-new">::new</a>) and a default registry (loaded
automatically or through interactions with <a
href="Types.html#method-i-5B-5D">#[]</a> and <a
href="Types.html#method-i-type_for">#type_for</a>).</p>

<h2 id="class-MIME::Types-label-The+Default+mime-types+Registry">The Default mime-types Registry<span><a href="#class-MIME::Types-label-The+Default+mime-types+Registry">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>The default mime-types registry is loaded automatically when the library is
required (<code>require &#39;mime/types&#39;</code>), but it may be lazily
loaded (loaded on first use) with the use of the environment variable
<code>RUBY_MIME_TYPES_LAZY_LOAD</code> having any value other than
<code>false</code>. The initial startup is about 14× faster (~10 ms vs ~140
ms), but the registry will be loaded at some point in the future.</p>

<p>The default mime-types registry can also be loaded from a Marshal cache
file specific to the version of <a href="Types.html">MIME::Types</a> being
loaded. This will be handled automatically with the use of a file referred
to in the environment variable <code>RUBY_MIME_TYPES_CACHE</code>. <a
href="Types.html">MIME::Types</a> will attempt to load the registry from
this cache file (MIME::Type::Cache.load); if it cannot be loaded (because
the file does not exist, there is an error, or the data is for a different
version of mime-types), the default registry will be loaded from the normal
JSON version and then the cache file will be <strong>written</strong> to
the location indicated by <code>RUBY_MIME_TYPES_CACHE</code>. Cache file
loads just over 4½× faster (~30 ms vs ~140 ms). loads.</p>

<p>Notes:</p>
<ul><li>
<p>The loading of the default registry is <strong>not</strong> atomic; when
using a multi-threaded environment, it is recommended that lazy loading is
not used and mime-types is loaded as early as possible.</p>
</li><li>
<p>Cache files should be specified per application in a multiprocess
environment and should be initialized during deployment or before forking
to minimize the chance that the multiple processes will be trying to write
to the same cache file at the same time, or that two applications that are
on different versions of mime-types would be thrashing the cache.</p>
</li><li>
<p>Unless cache files are preinitialized, the application using the mime-types
cache file must have read/write permission to the cache file.</p>
</li></ul>

<h2 id="class-MIME::Types-label-Usage">Usage<span><a href="#class-MIME::Types-label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;mime/types&#39;</span>

<span class="ruby-identifier">plaintext</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-string">&#39;text/plain&#39;</span>]
<span class="ruby-identifier">print</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">media_type</span>           <span class="ruby-comment"># =&gt; &#39;text&#39;</span>
<span class="ruby-identifier">print</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">sub_type</span>             <span class="ruby-comment"># =&gt; &#39;plain&#39;</span>

<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>)  <span class="ruby-comment"># =&gt; &#39;asc txt c cc h hh cpp&#39;</span>

<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">encoding</span>              <span class="ruby-comment"># =&gt; 8bit</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">binary?</span>               <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">ascii?</span>                <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">obsolete?</span>             <span class="ruby-comment"># =&gt; false</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span>.<span class="ruby-identifier">registered?</span>           <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-identifier">plaintext</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;text/plain&#39;</span>       <span class="ruby-comment"># =&gt; true</span>
<span class="ruby-identifier">puts</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>.<span class="ruby-identifier">simplified</span>(<span class="ruby-string">&#39;x-appl/x-zip&#39;</span>) <span class="ruby-comment"># =&gt; &#39;appl/zip&#39;</span>
</pre>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="VERSION">VERSION
        
        <dd><p>The release version of Ruby <a href="Types.html">MIME::Types</a></p>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-c-logger" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">logger</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Configure the <a href="Types.html">MIME::Types</a> logger. This defaults to
an instance of a logger that passes messages (unformatted) through to
Kernel#warn.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(type_id, complete: false, registered: false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Types.html#method-i-5B-5D">#[]</a> against the default <a
href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">complete</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">registered</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">__types__</span>[<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">complete</span><span class="ruby-operator">:</span> <span class="ruby-identifier">complete</span>, <span class="ruby-identifier">registered</span><span class="ruby-operator">:</span> <span class="ruby-identifier">registered</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-add" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add</span><span
            class="method-args">(*types)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Types.html#method-i-add">#add</a> against the default <a
href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="add-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 37</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">types</span>)
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">types</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Types.html#method-i-count">#count</a> against the default <a
href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="count-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each</span><span
            class="method-args">() { |t| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Types.html#method-i-each">#each</a> against the default <a
href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="each-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">t</span> }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">enum_for</span>(<span class="ruby-value">:each</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@type_variants</span>    = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@extension_index</span>  = <span class="ruby-constant">Container</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-of" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">of</span><span
            class="method-args">(filename)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Types.html#method-c-type_for">type_for</a>
        </div>
        
      </div>

    
      <div id="method-c-type_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">type_for</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p><a href="Types.html#method-i-type_for">#type_for</a> against the default <a
href="Types.html">MIME::Types</a> registry.</p>
          
          

          
          <div class="method-source-code" id="type_for-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-identifier">__types__</span>.<span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Types.html#method-c-of">of</a>
        </div>
        

        
      </div>

    
    </section>
  
     <section id="private-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Class Methods</h3>
       </header>

    
      <div id="method-c-__instances__" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">__instances__</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="__instances__-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">__instances__</span>
  <span class="ruby-ivar">@__instances__</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-__types__" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">__types__</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="__types__-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">__types__</span>
  (<span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@__types__</span>) <span class="ruby-keyword">and</span> <span class="ruby-ivar">@__types__</span>) <span class="ruby-keyword">or</span> <span class="ruby-identifier">load_default_mime_types</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-lazy_load-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">lazy_load?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="lazy_load-3F-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 43</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">lazy_load?</span>
  (<span class="ruby-identifier">lazy</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;RUBY_MIME_TYPES_LAZY_LOAD&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">lazy</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;false&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-load_default_mime_types" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_default_mime_types</span><span
            class="method-args">(mode = load_mode)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="load_default_mime_types-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_default_mime_types</span>(<span class="ruby-identifier">mode</span> = <span class="ruby-identifier">load_mode</span>)
  <span class="ruby-ivar">@__types__</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span>.<span class="ruby-identifier">load</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@__types__</span>
    <span class="ruby-ivar">@__types__</span> = <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Loader</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">mode</span>)
    <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span><span class="ruby-operator">::</span><span class="ruby-constant">Cache</span>.<span class="ruby-identifier">save</span>(<span class="ruby-ivar">@__types__</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@__types__</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-load_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_mode</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="load_mode-source">
            <pre><span class="ruby-comment"># File lib/mime/types/full.rb, line 9</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_mode</span>
  { <span class="ruby-identifier">columnar</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-reindex_extensions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reindex_extensions</span><span
            class="method-args">(type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="reindex_extensions-source">
            <pre><span class="ruby-comment"># File lib/mime/types/registry.rb, line 70</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reindex_extensions</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-identifier">__instances__</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">instance</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">instance</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:reindex_extensions!</span>, <span class="ruby-identifier">type</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-5B-5D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">[]</span><span
            class="method-args">(type_id, complete: false, registered: false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns a list of <a href="Type.html">MIME::Type</a> objects, which may be
empty. The optional flag parameters are <code>:complete</code> (finds only
complete <a href="Type.html">MIME::Type</a> objects) and
<code>:registered</code> (finds only <a href="Types.html">MIME::Types</a>
that are registered). It is possible for multiple matches to be returned
for either type (in the example below, &#39;text/plain&#39; returns two
values – one for the general case, and one for VMS systems).</p>

<pre class="ruby"><span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\nMIME::Types[&#39;text/plain&#39;]&quot;</span>
<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-string">&#39;text/plain&#39;</span>].<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">puts</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;, &quot;</span>) }

<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\nMIME::Types[/^image/, complete: true]&quot;</span>
<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>[<span class="ruby-regexp">/^image/</span>, :<span class="ruby-identifier">complete</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;, &quot;</span>)
<span class="ruby-keyword">end</span>
</pre>

<p>If multiple type definitions are returned, returns them sorted as follows:</p>

<pre>1. Complete definitions sort before incomplete ones;
2. IANA-registered definitions sort before LTSW-recorded
   definitions.
3. Current definitions sort before obsolete ones;
4. Obsolete definitions with use-instead clauses sort before those
   without;
5. Obsolete definitions use-instead clauses are compared.
6. Sort on name.</pre>
          
          

          
          <div class="method-source-code" id="5B-5D-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">type_id</span>, <span class="ruby-identifier">complete</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">registered</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">matches</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">type_id</span>
            <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">type_id</span>.<span class="ruby-identifier">simplified</span>]
            <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>
              <span class="ruby-identifier">match</span>(<span class="ruby-identifier">type_id</span>)
            <span class="ruby-keyword">else</span>
              <span class="ruby-ivar">@type_variants</span>[<span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Type</span>.<span class="ruby-identifier">simplified</span>(<span class="ruby-identifier">type_id</span>)]
            <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">prune_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">complete</span>, <span class="ruby-identifier">registered</span>).<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>)
  }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add</span><span
            class="method-args">(*types)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add one or more <a href="Type.html">MIME::Type</a> objects to the set of
known types. If the type is already known, a warning will be displayed.</p>

<p>The last parameter may be the value <code>:silent</code> or
<code>true</code> which will suppress duplicate <a
href="../MIME.html">MIME</a> type warnings.</p>
          
          

          
          <div class="method-source-code" id="add-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 167</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">types</span>)
  <span class="ruby-identifier">quiet</span> = ((<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-value">:silent</span>) <span class="ruby-keyword">or</span> (<span class="ruby-identifier">types</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">true</span>))

  <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">mime_type</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">mime_type</span>
    <span class="ruby-keyword">when</span> <span class="ruby-keyword">true</span>, <span class="ruby-keyword">false</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-constant">Symbol</span>
      <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>
      <span class="ruby-identifier">variants</span> = <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-value">:@type_variants</span>)
      <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">:+</span>).<span class="ruby-identifier">to_a</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
      <span class="ruby-identifier">add</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">mime_type</span>, <span class="ruby-identifier">quiet</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_type" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_type</span><span
            class="method-args">(type, quiet = false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add a single <a href="Type.html">MIME::Type</a> object to the set of known
types. If the <code>type</code> is already known, a warning will be
displayed. The <code>quiet</code> parameter may be a truthy value to
suppress that warning.</p>
          
          

          
          <div class="method-source-code" id="add_type-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 188</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">add_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">quiet</span> = <span class="ruby-keyword">false</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">quiet</span> <span class="ruby-keyword">and</span> <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">type</span>.<span class="ruby-identifier">simplified</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">type</span>)
      <span class="ruby-constant">MIME</span><span class="ruby-operator">::</span><span class="ruby-constant">Types</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">warn</span> <span class="ruby-value">&lt;&lt;-warning
Type #{type} is already registered as a variant of #{type.simplified}.
      warning</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">add_type_variant!</span>(<span class="ruby-identifier">type</span>)
    <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">count</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the number of known type variants.</p>
          
          

          
          <div class="method-source-code" id="count-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">count</span>
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">a</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">size</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each</span><span
            class="method-args">() { |t| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Iterates through the type variants.</p>
          
          

          
          <div class="method-source-code" id="each-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 91</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">each_value</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">tv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">tv</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span> <span class="ruby-identifier">t</span> } }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">enum_for</span>(<span class="ruby-value">:each</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-of" class="method-detail method-alias">
        
        <div class="method-heading">
          <span class="method-name">of</span><span
            class="method-args">(filename)</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
        </div>

        

        
        <div class="aliases">
          Alias for: <a href="Types.html#method-i-type_for">type_for</a>
        </div>
        
      </div>

    
      <div id="method-i-type_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">type_for</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the list of <a href="Types.html">MIME::Types</a> which belongs to
the file based on its filename extension. If there is no extension, the
filename will be used as the matching criteria on its own.</p>

<p>This will always return a merged, flatten, priority sorted, unique array.</p>

<pre>puts MIME::Types.type_for(&#39;citydesk.xml&#39;)
  =&gt; [application/xml, text/xml]
puts MIME::Types.type_for(&#39;citydesk.gif&#39;)
  =&gt; [image/gif]
puts MIME::Types.type_for(%w(citydesk.xml citydesk.gif))
  =&gt; [application/xml, image/gif, text/xml]</pre>
          
          

          
          <div class="method-source-code" id="type_for-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">type_for</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-constant">Array</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">flat_map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">fn</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@extension_index</span>[<span class="ruby-identifier">fn</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">downcase</span>[<span class="ruby-regexp">/\.?([^.]*?)$/</span>, <span class="ruby-value">1</span>]]
  }.<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">:+</span>).<span class="ruby-identifier">sort</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">a</span>.<span class="ruby-identifier">priority_compare</span>(<span class="ruby-identifier">b</span>)
  }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        
        <div class="aliases">
          Also aliased as: <a href="Types.html#method-i-of">of</a>
        </div>
        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-add_type_variant-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_type_variant!</span><span
            class="method-args">(mime_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="add_type_variant-21-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 201</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_type_variant!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mime_type</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-index_extensions-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_extensions!</span><span
            class="method-args">(mime_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="index_extensions-21-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 210</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">extensions</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ext</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@extension_index</span>[<span class="ruby-identifier">ext</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">mime_type</span> }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">match</span><span
            class="method-args">(pattern)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="match-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 220</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">match</span>(<span class="ruby-identifier">pattern</span>)
  <span class="ruby-ivar">@type_variants</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">_</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">k</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">pattern</span>
  }.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">:+</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-prune_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prune_matches</span><span
            class="method-args">(matches, complete, registered)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="prune_matches-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prune_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">complete</span>, <span class="ruby-identifier">registered</span>)
  <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e</span>.<span class="ruby-identifier">complete?</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">complete</span>
  <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">delete_if</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">e</span>.<span class="ruby-identifier">registered?</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">registered</span>
  <span class="ruby-identifier">matches</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-reindex_extensions-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reindex_extensions!</span><span
            class="method-args">(mime_type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="reindex_extensions-21-source">
            <pre><span class="ruby-comment"># File lib/mime/types.rb, line 205</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reindex_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@type_variants</span>[<span class="ruby-identifier">mime_type</span>.<span class="ruby-identifier">simplified</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">mime_type</span>)
  <span class="ruby-identifier">index_extensions!</span>(<span class="ruby-identifier">mime_type</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

